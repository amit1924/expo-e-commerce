<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Dashboard Stats Explained â€“ Step by Step</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              dark: '#0f172a',
              neon: '#38bdf8',
              green: '#22c55e',
              purple: '#a855f7',
              yellow: '#facc15',
            },
            boxShadow: {
              neon: '0 0 15px rgba(56,189,248,0.6)',
            },
          },
        },
      };
    </script>
  </head>

  <body class="bg-dark text-gray-200">
    <!-- HEADER -->
    <header class="text-center py-8">
      <h1 class="text-3xl font-bold text-neon drop-shadow-[0_0_10px_#38bdf8]">
        ğŸ“Š Dashboard Statistics API
      </h1>
      <p class="text-gray-400 mt-2">
        Explained step by step with examples (Teacher Mode ğŸ‘¨â€ğŸ«)
      </p>
    </header>

    <main class="max-w-6xl mx-auto px-6 space-y-10">
      <!-- BIG IDEA -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-green">
          <i class="fas fa-lightbulb"></i> Big Idea (One Line)
        </h2>
        <p class="mt-3 text-lg">
          This API collects <b>summary numbers</b> for the admin dashboard.
        </p>
        <ul class="list-disc list-inside mt-3">
          <li>Total orders</li>
          <li>Total revenue</li>
          <li>Total products</li>
          <li>Total customers</li>
        </ul>
      </section>

      <!-- FULL CODE -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-neon">
          <i class="fas fa-code"></i> Full Code
        </h2>

        <pre
          class="bg-black p-4 rounded-lg mt-4 text-sm text-gray-300 overflow-x-auto"
        >
export async function getDashboardStats(_, res) {
  try {
    const totalOrders = await Order.countDocuments();

    const revenueResult = await Order.aggregate([
      {
        $group: {
          _id: null,
          total: { $sum: '$totalPrice' },
        },
      },
    ]);

    const totalRevenue = revenueResult[0]?.total || 0;

    const totalProducts = await Product.countDocuments();
    const totalCustomers = await User.countDocuments();

    res.status(200).json({
      totalOrders,
      totalRevenue,
      totalProducts,
      totalCustomers,
    });
  } catch (error) {
    res.status(500).json({ message: 'Internal server error' });
  }
}
  </pre
        >
      </section>

      <!-- STEP 1 -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-purple">
          <i class="fas fa-play-circle"></i> Step 1: Function Start
        </h2>

        <p class="mt-3">
          This function runs when <b>admin opens dashboard</b>.
        </p>

        <p class="mt-2 text-gray-400">
          <b>_</b> â†’ request is not used <br />
          <b>res</b> â†’ used to send response
        </p>
      </section>

      <!-- STEP 2 -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-green">
          <i class="fas fa-receipt"></i> Step 2: Count Total Orders
        </h2>

        <pre class="bg-black p-4 rounded-lg mt-4 text-sm text-gray-300">
const totalOrders = await Order.countDocuments();
  </pre
        >

        <p class="mt-4">ğŸ“¦ Counts how many orders exist in database.</p>

        <p class="mt-3 text-yellow-300">ğŸ§  Example:</p>
        <ul class="list-disc list-inside mt-2">
          <li>Order #1</li>
          <li>Order #2</li>
          <li>Order #3</li>
        </ul>

        <p class="mt-2">ğŸ‘‰ <b>totalOrders = 3</b></p>
      </section>

      <!-- STEP 3 -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-neon">
          <i class="fas fa-coins"></i> Step 3: Calculate Total Revenue
        </h2>

        <pre class="bg-black p-4 rounded-lg mt-4 text-sm text-gray-300">
const revenueResult = await Order.aggregate([
  {
    $group: {
      _id: null,
      total: { $sum: '$totalPrice' },
    },
  },
]);
  </pre
        >

        <p class="mt-4">
          ğŸ§® MongoDB aggregation is used to <b>add all order prices</b>.
        </p>

        <p class="mt-3 text-yellow-300">ğŸ§  Example Orders:</p>

        <table class="mt-3 w-full text-left border border-gray-700">
          <thead class="bg-slate-800">
            <tr>
              <th class="p-2">Order</th>
              <th class="p-2">totalPrice</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="p-2">Order 1</td>
              <td class="p-2">â‚¹1000</td>
            </tr>
            <tr>
              <td class="p-2">Order 2</td>
              <td class="p-2">â‚¹2500</td>
            </tr>
            <tr>
              <td class="p-2">Order 3</td>
              <td class="p-2">â‚¹1500</td>
            </tr>
          </tbody>
        </table>

        <p class="mt-3">ğŸ‘‰ Total Revenue = <b>1000 + 2500 + 1500 = â‚¹5000</b></p>
      </section>

      <!-- STEP 4 -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-purple">
          <i class="fas fa-shield-alt"></i> Step 4: Safe Revenue Handling
        </h2>

        <pre class="bg-black p-4 rounded-lg mt-4 text-sm text-gray-300">
const totalRevenue = revenueResult[0]?.total || 0;
  </pre
        >

        <p class="mt-4">âœ”ï¸ If no orders exist â†’ revenueResult is empty.</p>

        <p class="mt-2">
          ğŸ‘‰ This line prevents <b>app crash</b> and safely returns <b>0</b>.
        </p>
      </section>

      <!-- STEP 5 -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-green">
          <i class="fas fa-box"></i> Step 5: Count Products
        </h2>

        <pre class="bg-black p-4 rounded-lg mt-4 text-sm text-gray-300">
const totalProducts = await Product.countDocuments();
  </pre
        >

        <p class="mt-4">ğŸ“¦ Counts how many products are available.</p>

        <p class="mt-2 text-yellow-300">
          Example: iPhone, Laptop, Shoes â†’ <b>3 products</b>
        </p>
      </section>

      <!-- STEP 6 -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-neon">
          <i class="fas fa-users"></i> Step 6: Count Customers
        </h2>

        <pre class="bg-black p-4 rounded-lg mt-4 text-sm text-gray-300">
const totalCustomers = await User.countDocuments();
  </pre
        >

        <p class="mt-4">ğŸ‘¥ Counts registered users.</p>

        <p class="mt-2 text-yellow-300">
          Example: Rahul, Amit, Neha â†’ <b>3 customers</b>
        </p>
      </section>

      <!-- STEP 7 -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-purple">
          <i class="fas fa-paper-plane"></i> Step 7: Send Response
        </h2>

        <pre class="bg-black p-4 rounded-lg mt-4 text-sm text-gray-300">
res.status(200).json({
  totalOrders,
  totalRevenue,
  totalProducts,
  totalCustomers,
});
  </pre
        >

        <p class="mt-4">ğŸ“¤ Sends all numbers to frontend dashboard.</p>

        <p class="mt-2">ğŸ‘‰ Frontend shows cards like:</p>

        <ul class="list-disc list-inside mt-2">
          <li>Total Orders: 3</li>
          <li>Total Revenue: â‚¹5000</li>
          <li>Total Products: 3</li>
          <li>Total Customers: 3</li>
        </ul>
      </section>

      <!-- ERROR HANDLING -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-red-400">
          <i class="fas fa-bug"></i> Error Handling
        </h2>

        <p class="mt-3">If anything goes wrong:</p>

        <ul class="list-disc list-inside mt-2">
          <li>Database down</li>
          <li>Query failed</li>
          <li>Server issue</li>
        </ul>

        <p class="mt-3">ğŸ‘‰ Server returns <b>500 Internal Server Error</b></p>
      </section>

      <!-- FINAL SUMMARY -->
      <section class="bg-slate-900 p-6 rounded-xl shadow-neon">
        <h2 class="text-xl font-semibold text-neon">
          <i class="fas fa-check-circle"></i> 30-Second Final Summary
        </h2>

        <ul class="list-disc list-inside mt-4 space-y-1">
          <li>Count orders</li>
          <li>Sum revenue</li>
          <li>Count products</li>
          <li>Count users</li>
          <li>Send data to dashboard</li>
        </ul>
      </section>
    </main>

    <footer class="text-center py-6 text-gray-500">
      Dashboard stats made easy ğŸ’™
    </footer>
  </body>
</html>
